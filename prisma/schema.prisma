// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
}

model Customers {
  id            String  @id @default(cuid())
  email         String  @unique
  name          String
  lastname      String
  phone         String
  status        CustomerStatus  @default(active)
  createdAt     DateTime  @default(now())
  services      Services[]
  supports      Supports[]
  houses        CustomerHouses[]
}

enum CustomerStatus {
  active
  suspended
}

model CustomerHouses {
  id            String  @id @default(cuid())
  customerId    String
  latitude      Float
  longitude     Float
  address       String
  distribution  Json
  sizeSqm       Int?
  type          CustomerHouseType
  customer      Customers @relation(fields: [customerId], references: [id])
}

enum CustomerHouseType {
  flat
  house
  office
}

model Housemaids {
  id            String  @id @default(cuid())
  email         String @unique
  name          String
  lastname      String
  phone         String
  address       String
  status        HousemaidStatus  @default(training)
  createdAt     DateTime  @default(now())
  services      Services[]
  schedule      Schedules[]
  supports      Supports[]
  typeService   TypesServices[]
}

enum HousemaidStatus {
  active
  suspended
  fired
  medical_leave
  vacation
  training
}

model Services {
  id            String  @id @default(cuid())
  customerId    String
  housemaidId   String
  typeServiceId String
  initialDate   DateTime
  endDate       DateTime
  createdAt     DateTime @default(now())
  status        ServiceStatus @default(scheduled)
  schedule      Schedules?
  customer      Customers @relation(fields: [customerId], references: [id])
  housemaid     Housemaids @relation(fields: [housemaidId], references: [id])
  typeService   TypesServices @relation(fields: [typeServiceId], references: [id])
}

enum ServiceStatus {
  scheduled
  in_progress
  suspended
  finished
  canceled
}

model TypesServices {
  id          String   @id @default(cuid())
  title       String
  description String
  price       Int
  createdAt   DateTime @default(now())
  services    Services[]
  housemaids  Housemaids[]
}

model Evaluations {
  id                String   @id @default(cuid())
  evaluatedEntity   EvaluatedEntityType
  evaluatedEntityId String
  score             Int
  comments          String
  title             String
  type              EvaluationsType
  createdAt         DateTime @default(now())
}

enum EvaluationsType {
  customer_review
  housemaid_review
}

enum EvaluatedEntityType {
  housemaid
  customer
  service
}

model Schedules {
  id          String   @id @default(cuid())
  housemaidId String
  serviceId   String @unique
  days        String[]
  hours       String[]
  createdAt   DateTime @default(now())
  housemaid   Housemaids @relation(fields: [housemaidId], references: [id])
  service     Services @relation(fields: [serviceId], references: [id])   
}

model Documents {
  id                String  @id @default(cuid())
  title             String
  url               String
  type              DocumentType
  documentOwnerType DocumentOwnerType
  documentOwnerId   String
  createdAt         DateTime  @default(now())
}

enum DocumentType {
  contract
  id_card
  resume
  background_check
  support_document
}

enum DocumentOwnerType {
  CUSTOMER
  HOUSEMAID
  SUPPORT_TICKET
}

model Supports {
  id          String  @id @default(cuid())
  housemaidId String
  customerId  String
  tittle      String
  comments    String
  status      SupportStatus @default(new)
  createdAt   DateTime @default(now())
  housemaid   Housemaids @relation(fields: [housemaidId], references: [id])
  customer    Customers @relation(fields: [customerId], references: [id])
}

enum SupportStatus {
  new
  in_progress
  closed
}